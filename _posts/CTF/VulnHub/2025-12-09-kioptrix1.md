---
title: "VulnHub: Kioptrix Level 1"
date: 2025-12-09
categories: [CTFs, VulnHub, Easy]
tags: [VulnHub]
---

Machine by Kioptrix

Vulnhub [link](https://www.vulnhub.com/entry/kioptrix-level-1-1,22/)

Objectives:

- Get root access
- Find the flag

---

## Tools Used:<!-- omit in toc -->

- Kali Linux
- NMAP
- DIRB
- OpenFuck
- ncat
- gcc

---

### 1. Nmap Scan

We'll use an intense nmap scan on the victim vm (192.168.56.133), we can see multiple services running:

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_01.png)

<br>

### 2. Dirb reconnaissance

Using DIRB to enumerate directories on the web server, we can see several directories and pages:

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_02.png)

<br>

### 3. Identifying vulnerabilities

From the NMAP scan, we can see that the machine is running outdated versions:
- Apache 1.3.20 with mod_ssl 2.8.4
- OpenSSH 2.9p2

These versions are known to have vulnerabilities. The Apache version is vulnerable to the OpenSSL Exploit (OpenFuck).

<br>

### 4. Preparing the OpenFuck exploit

First, we need to clone or download the OpenFuck exploit from GitHub

<br>

Then we compile it with GCC:

```bash
gcc -o OpenFuck OpenFuck.c -lcrypto
```

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_04.png)

<br>

### 5. Executing the OpenFuck exploit

We execute the exploit with the target IP, the port (443 for HTTPS), and the offset:

```bash
./OpenFuck 0x6d 192.168.56.133 443 -C 40
```

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_05.png)

<br>

If successful, we should get a shell spawned:

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_06.png)

<br>

### 6. Verifying shell access

We verify that we have shell access to the system:

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_07.png)

<br>

### 7. Checking kernel version

Let's check the kernel version of the system to see if there's a privilege escalation vulnerability:

```bash
uname -a
```

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_08.png)

<br>

The kernel version 2.4.7-10 is vulnerable to the ptrace/kmod local privilege escalation vulnerability (CVE-2003-0127).

<br>

### 8. Privilege escalation

We can see from exploit-db that there's a ptrace/kmod exploit for this kernel version:

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_09.png)

<br>

We compile the exploit:

```bash
gcc -o exploit ptrace-kmod.c -lcrypto
```

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_10.png)

<br>

And execute it:

```bash
./exploit
```

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_11.png)

<br>

### 9. Getting root access

Once we execute the privilege escalation exploit, we get a root shell:

![](/assets/img/ctf/vulnhub/kioptrix1/kioptrix1_12.png)

<br>

We now have full root access to the system and can retrieve any sensitive information or flags from the machine.

